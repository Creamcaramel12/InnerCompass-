<!DOCTYPE html>
<html>
<head>
    <title>InnerCompass V2.3</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
        /* --- CSS: Core Design for InnerCompass --- */
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            min-height: 100vh;
            /* Calming PURPLE Background Gradient */
            background: linear-gradient(135deg, #e0c3fc 0%, #8ec5fc 100%); 
            color: #333;
            padding-bottom: 60px; 
        }
        .container {
            width: 90%;
            max-width: 500px; 
            padding: 20px;
            text-align: center;
        }
        .checkin-box { 
            background-color: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08); 
            margin-bottom: 20px;
        }
        h1 {
            font-family: 'Poppins', sans-serif;
            color: #7a50b7; 
            font-size: 30px; 
            margin-bottom: 15px; 
            font-weight: 600;
        }
        h2 {
            color: #7a50b7;
            margin-bottom: 20px;
        }
        #prompt {
            font-size: 1.2em;
            margin-bottom: 20px;
            color: #555;
            font-weight: 400;
        }
        
        /* --- Mood and Weather Button Styling --- */
        #moodSelector, #weatherSelector {
            display: flex;
            justify-content: space-around;
            margin-bottom: 15px;
            padding: 10px 0;
        }
        .mood-btn, .weather-btn {
            font-size: 2.5em; 
            background: none;
            border: none;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            transition: transform 0.2s, background-color 0.2s;
            opacity: 0.6; 
        }
        .weather-btn {
            font-size: 1.8em; 
            padding: 8px;
        }
        .mood-btn.selected, .weather-btn.selected {
            opacity: 1;
            transform: scale(1.1);
            background-color: rgba(122, 80, 183, 0.2); 
        }

        /* --- Journal and Save Button --- */
        #journalEntry {
            width: 100%;
            min-height: 120px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 10px;
            resize: none;
            font-size: 1em;
            box-sizing: border-box;
            margin-bottom: 15px;
        }
        #saveBtn {
            background-color: #7a50b7; 
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 30px;
            font-size: 1.1em;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            transition: background-color 0.3s;
            width: 100%;
            margin-top: 5px;
        }
        #saveBtn:disabled {
            background-color: #bfa9d8; 
            cursor: not-allowed;
        }
        
        /* --- Prompt Styling --- */
        #journalPromptSection {
            text-align: left;
            margin-top: 15px;
        }
        .prompt-title {
            font-weight: bold;
            color: #7a50b7;
            margin-bottom: 5px;
        }
        .prompt-locked {
            color: #e7c06c; 
            font-style: italic;
            padding: 10px;
            border: 1px dashed #e7c06c;
            border-radius: 5px;
            cursor: pointer;
            display: block;
        }

        /* --- Navigation Button Style --- */
        .nav-btn {
            background-color: #bfa9d8; 
            color: #333;
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            font-size: 0.9em;
            cursor: pointer;
            margin-top: 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: background-color 0.3s;
        }
        .nav-btn:hover {
            background-color: #a98fcf;
        }
        
        /* --- Journal and Chart Styling --- */
        #moodChart {
            height: 200px;
            width: 100%;
            margin: 20px 0;
            background-color: white;
            border-radius: 8px;
            padding: 10px 5px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            display: flex; 
            align-items: flex-end;
            justify-content: space-around;
        }
        .entry-item {
            padding: 10px;
            border-bottom: 1px solid #eee;
            margin-bottom: 5px;
            background-color: white;
            border-radius: 5px;
        }
        .entry-date {
            font-weight: bold;
            color: #7a50b7;
            display: block;
            margin-bottom: 3px;
        }
        .entry-note {
            font-size: 0.9em;
            color: #555;
            display: block;
        }
        .entry-mood {
            float: right;
            font-size: 1.5em;
        }
        #entriesList {
            list-style: none;
            padding: 0;
            width: 100%;
            text-align: left;
        }
        
        /* --- PRO Modal/Popup Styling --- */
        .modal-content {
            /* Styles for the Pro Modal */
        }
        #unlockBtn {
            background-color: #48bb78; 
        }
        /* --- Footer (for Ad Banner Placeholder) --- */
        .ad-banner-placeholder {
            width: 100%;
            height: 50px;
            background-color: #ddd;
            text-align: center;
            line-height: 50px;
            font-size: 0.9em;
            position: fixed;
            bottom: 0;
            left: 0;
            z-index: 1000;
            color: #555;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>
    
    <div id="checkinView" class="container">
        <h1 id="greetingHeader">InnerCompass üß≠</h1>
        
        <div class="checkin-box">
            <p id="prompt">How are you feeling right now?</p>
            <div id="moodSelector">
                <button class="mood-btn" data-mood="1">üò©</button>
                <button class="mood-btn" data-mood="2">üòü</button>
                <button class="mood-btn" data-mood="3">üòê</button>
                <button class="mood-btn" data-mood="4">üòä</button>
                <button class="mood-btn" data-mood="5">ü•≥</button>
            </div>
            
            <hr style="border: 0; height: 1px; background-color: #eee;">
            
            <p style="font-size: 1.1em; margin-bottom: 10px; color: #555;">What's the weather like?</p>
            <div id="weatherSelector">
                <button class="weather-btn" data-weather="Sunny">‚òÄÔ∏è</button>
                <button class="weather-btn" data-weather="Cloudy">‚òÅÔ∏è</button>
                <button class="weather-btn" data-weather="Rainy">üåßÔ∏è</button>
                <button class="weather-btn" data-weather="Snowy">‚ùÑÔ∏è</button>
                <button class="weather-btn" data-weather="Hot">üî•</button>
                <button class="weather-btn" data-weather="Cold">ü•∂</button>
            </div>
        </div>

        <div id="journalPromptSection">
            </div>

        <textarea id="journalEntry" placeholder="Write a short note about why you feel this way... (optional)"></textarea>

        <button id="saveBtn" disabled>Save Entry</button>
        
        <button id="goToJournal" class="nav-btn">View History ‚Üí</button> 
    </div>

    <div id="journalView" class="container" style="display: none;">
        <h2>Your Mood History</h2>
        
        <div id="moodChart" style="height: 200px; width: 100%; margin-bottom: 20px;">
            </div>

        <ul id="entriesList">
            </ul>

        <button id="goToPro" class="nav-btn" style="background-color: #f39c12; color: white; margin-bottom: 10px;">‚ú® Go Pro: Ad-Free & Unlock Data</button>
        
        <button id="goToCheckin" class="nav-btn">‚Üê New Check-in</button>
    </div>
    
    <div class="ad-banner-placeholder">
        [Start.io Banner Ad Will Go Here]
    </div>

    <div id="proModal" style="display: none; position: fixed; z-index: 1001; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.4); justify-content: center; align-items: center;">
        <div class="modal-content" style="background-color: #fefefe; margin: 15% auto; padding: 20px; border: 1px solid #888; width: 80%; max-width: 400px; border-radius: 10px;">
            <span class="close-btn" style="color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer;">&times;</span>
            <h2>InnerCompass Pro</h2>
            <p>Go Ad-Free and securely back up all your private data for a one-time fee!</p>
            
            <a href="https://paypal.me/moonscape44/1.99" target="_blank" style="text-decoration: none; display: block;">
                <button class="nav-btn" style="background-color: #3498db; color: white; margin-bottom: 15px;">Buy Pro Access ($1.99)</button>
            </a>

            <hr>
            <p style="font-size: 0.9em; margin-bottom: 5px;">Already paid? Enter your unlock code:</p>
            <input type="text" id="proCodeInput" placeholder="Enter Code (e.g., INNERPRO2025)" style="width: 90%; padding: 10px; margin-bottom: 10px; border-radius: 5px; border: 1px solid #ccc;">
            <button id="unlockBtn" class="nav-btn" style="background-color: #48bb78; color: white;">Unlock Now</button>
        </div>
    </div>


    <script>
        // --- VARIABLE DECLARATIONS (Must be first) ---
        const saveButton = document.getElementById('saveBtn');
        const journalEntryInput = document.getElementById('journalEntry');
        const journalPromptSection = document.getElementById('journalPromptSection'); 

        // Use querySelectorAll to get collections
        const moodButtons = document.querySelectorAll('.mood-btn');
        const weatherButtons = document.querySelectorAll('.weather-btn'); 
        
        let selectedMood = null;
        let selectedWeather = null; 

        // Pro Modal Elements
        const proModal = document.getElementById('proModal');
        const closeModal = document.querySelector('#proModal .close-btn');
        const goToProBtn = document.getElementById('goToPro');
        const unlockBtn = document.getElementById('unlockBtn');
        const proCodeInput = document.getElementById('proCodeInput');
        const adBannerPlaceholder = document.querySelector('.ad-banner-placeholder');

        // IMPORTANT: CHANGE THIS CODE
        const UNLOCK_CODE = "COMPASSGOLD37"; // Example Code - CHANGE THIS!
        const MOOD_EMOJIS = {
            1: 'üò©', 2: 'üòü', 3: 'üòê', 4: 'üòä', 5: 'ü•≥'
        };
        
        // Function to check if both mood and weather are selected
        const checkReadyToSave = () => {
            if (selectedMood && selectedWeather) {
                if(saveButton) saveButton.disabled = false;
            } else {
                if(saveButton) saveButton.disabled = true;
            }
        };

        // --- Data Storage and Retrieval ---
        function loadEntries() {
            const entriesJson = localStorage.getItem('moodEntries');
            return entriesJson ? JSON.parse(entriesJson) : [];
        }

        function saveEntry() {
            if (!selectedMood || !selectedWeather) return;

            const now = new Date();
            const formattedDate = now.toLocaleDateString() + ' ' + now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });

            const newEntry = {
                id: Date.now(),
                date: formattedDate,
                mood: parseInt(selectedMood),
                weather: selectedWeather, 
                note: journalEntryInput.value.trim()
            };

            const allEntries = loadEntries();
            allEntries.push(newEntry);
            localStorage.setItem('moodEntries', JSON.stringify(allEntries));
            
            // Alert message removed per your request.

            showView('journalView'); 

            // Reset UI
            moodButtons.forEach(btn => btn.classList.remove('selected'));
            weatherButtons.forEach(btn => btn.classList.remove('selected')); 
            journalEntryInput.value = '';
            if(saveButton) saveButton.disabled = true;
            selectedMood = null;
            selectedWeather = null; 
        }

        // --- Display Entries and Chart Logic ---
        function displayEntries() {
            const entries = loadEntries().reverse();
            const list = document.getElementById('entriesList');
            const chart = document.getElementById('moodChart');
            
            if(!list || !chart) return; // Guard against missing elements
            
            list.innerHTML = ''; 
            chart.innerHTML = ''; 

            if (entries.length === 0) {
                chart.innerHTML = '<p style="padding-top: 80px; color: #777;">No data for chart yet.</p>';
                list.innerHTML = '<li style="text-align: center; color: #777; padding: 20px;">No entries saved yet.</li>';
                chart.style.display = 'block'; 
                return;
            }

            // 1. Build Chart (Flexbox/CSS Bars)
            const recentEntries = entries.slice(0, 7); 
            chart.style.display = 'flex';
            chart.style.alignItems = 'flex-end';
            chart.style.justifyContent = 'space-around';

            const moodColors = {
                1: '#e74c3c', 2: '#f09a34', 3: '#f1c40f', 4: '#5cb85c', 5: '#2ecc71'
            };

            recentEntries.forEach((entry) => {
                const height = entry.mood * 20; 
                const bar = document.createElement('div');
                
                bar.style.height = `${height}%`;
                bar.style.width = '10%';
                bar.style.backgroundColor = moodColors[entry.mood] || '#95a5a6';
                bar.style.margin = '0 2%';
                bar.style.borderRadius = '5px 5px 0 0';
                bar.style.boxShadow = '0 -2px 5px rgba(0,0,0,0.1)';
                bar.title = `${entry.date}\nMood: ${MOOD_EMOJIS[entry.mood] || entry.mood}\nWeather: ${entry.weather}`;

                chart.appendChild(bar);
            });

            // 2. Build List 
            const moodNames = {
                1: 'Awful', 2: 'Bad', 3: 'Neutral', 4: 'Good', 5: 'Great'
            };
            
            entries.forEach(entry => {
                const li = document.createElement('li');
                li.className = 'entry-item';
                li.innerHTML = `
                    <span class="entry-mood">${MOOD_EMOJIS[entry.mood] || entry.mood} (${moodNames[entry.mood]})</span>
                    <span class="entry-date">${entry.date} - ${entry.weather}</span>
                    <span class="entry-note">${entry.note || 'No note added'}</span>
                `;
                list.appendChild(li);
            });
        }
        
        // --- PRO UPGRADE LOGIC ---
        function checkProStatus() {
            const isPro = localStorage.getItem('isProUser') === 'true';
            
            if (isPro) {
                if(adBannerPlaceholder) adBannerPlaceholder.style.display = 'none'; 
                if (goToProBtn) goToProBtn.style.display = 'none'; 
                document.body.style.paddingBottom = '0';
                displayPrompts(true); 
            } else {
                if(adBannerPlaceholder) adBannerPlaceholder.style.display = 'block'; 
                if (goToProBtn) goToProBtn.style.display = 'block';
                document.body.style.paddingBottom = '60px';
                displayPrompts(false); 
            }
            return isPro;
        }
        
        function unlockPro() {
            const inputCode = proCodeInput.value.toUpperCase().trim();
            
            if (inputCode === UNLOCK_CODE) {
                localStorage.setItem('isProUser', 'true');
                if(proModal) proModal.style.display = 'none';
                alert('Success! InnerCompass Pro features unlocked!');
                checkProStatus();
            } else {
                alert('Invalid unlock code. Please check your code and try again.');
            }
        }

        function showView(viewId) {
            const checkinView = document.getElementById('checkinView');
            const journalView = document.getElementById('journalView');
            
            if(checkinView) checkinView.style.display = 'none';
            if(journalView) journalView.style.display = 'none';
            
            const targetView = document.getElementById(viewId);
            if(targetView) targetView.style.display = 'block';
            
            if (viewId === 'journalView') {
                displayEntries();
            }
        }
        
        // Journal Prompt Logic
        function displayPrompts(isProUser) {
            if(!journalPromptSection) return;

            const prompts = [
                "What is one thing you can do today that brings you closer to your goal?",
                "Describe a challenge you overcame this week and how you did it.",
                "If you could talk to your past self, what advice would you give regarding your mood?",
                "Identify two small things you are grateful for right now."
            ];
            
            if (isProUser) {
                const randomPrompt = prompts[Math.floor(Math.random() * prompts.length)];
                journalPromptSection.innerHTML = `
                    <p class="prompt-title">üåü Daily Reflection Prompt:</p>
                    <p style="font-size: 1.1em; color: #333; font-style: italic;">"${randomPrompt}"</p>
                `;
            } else {
                journalPromptSection.innerHTML = `
                    <span class="prompt-locked" onclick="proModal.style.display = 'block'">
                        üîí Unlock 4+ Daily Prompts with InnerCompass Pro!
                    </span>
                `;
            }
        }

        // Dynamic Greeting Function
        function updateGreeting() {
            const header = document.getElementById('greetingHeader');
            const hour = new Date().getHours();
            let greeting = "Hello";
            
            if (hour >= 5 && hour < 12) {
                greeting = "Good Morning";
            } else if (hour >= 12 && hour < 18) {
                greeting = "Good Afternoon";
            } else {
                greeting = "Good Evening";
            }
            if(header) header.textContent = `${greeting}, InnerCompass üß≠`;
        }

        // --- Event Listeners and Initializer (Wrapped for reliability) ---
        document.addEventListener('DOMContentLoaded', () => {
            
            // 1. Handle Mood Selection 
            if (moodButtons.length > 0) {
                moodButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        moodButtons.forEach(btn => btn.classList.remove('selected'));
                        button.classList.add('selected');
                        selectedMood = button.getAttribute('data-mood');
                        checkReadyToSave();
                    });
                });
            }

            // 2. Handle Weather Selection 
            if (weatherButtons.length > 0) {
                weatherButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        weatherButtons.forEach(btn => btn.classList.remove
// Pro Features
            function checkProStatus() {
                // Example placeholder ‚Äî complete this or remove it if unused
                const isPro = localStorage.getItem('proUnlocked') === 'true';
                if (isPro) {
                    elements.adBanner.style.display = 'none';
                }
            }

            // Run initialization
            displayEntries();
            checkProStatus();

            // Event Listeners
            elements.moodButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    elements.moodButtons.forEach(b => b.classList.remove('selected'));
                    btn.classList.add('selected');
                    selectedMood = btn.dataset.mood;
                    elements.saveButton.disabled = false;
                });
            });

            elements.weatherButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    elements.weatherButtons.forEach(b => b.classList.remove('selected'));
                    btn.classList.add('selected');
                    selectedWeather = btn.dataset.weather;
                });
            });

            elements.saveButton.addEventListener('click', saveEntry);
            elements.goToJournalBtn.addEventListener('click', () => showView('journal'));
            elements.goToCheckinBtn.addEventListener('click', () => showView('checkin'));
            elements.goToProBtn.addEventListener('click', () => elements.proModal.style.display = 'block');
            elements.closeModal.addEventListener('click', () => elements.proModal.style.display = 'none');
            elements.unlockBtn.addEventListener('click', () => {
                if (elements.proCodeInput.value.trim() === UNLOCK_CODE) {
                    localStorage.setItem('proUnlocked', 'true');
                    elements.adBanner.style.display = 'none';
                    alert('Pro access unlocked!');
                    elements.proModal.style.display = 'none';
                } else {
                    alert('Invalid code.');
                }
            });

            function showView(view) {
                elements.checkinView.classList.toggle('active', view === 'checkin');
                elements.journalView.classList.toggle('active', view === 'journal');
                if (view === 'journal') displayEntries();
            }

        })();
    </script>
</body>
</html>
